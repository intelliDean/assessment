// scripts/deploy.js
const hre = require("hardhat");
import { ethers } from "hardhat";

const main = async () => {
  // Get 'OnChainNFT' contract
  const OnChainNFT = await hre.ethers.getContractFactory('OnChainNFT');

  // Deploy contract
  const onChainNFT = await OnChainNFT.deploy();

  console.log('âœ… Contract deployed to:', onChainNFT.target);

  // I did the Base64 encoding outside of the code, the text version of the svg was taken to https://www.base64encode.org/ to encode
  //after the encoding, the encoded svg was concatenated with ( data:image/svg+xml;base64,) like it's below. The encoded svg started with P not the comma
  const base64EncodeOfTheSVG = `data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwcHgiIGhlaWdodD0iODAwcHgiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0zNy4xMDU1IDE2LjIzMTJMMTkuMTY3NCAyMy43ODQxTDI3LjYyMjEgNDQuMTQxOEw0NS40ODQ5IDM2LjgzOUwzNy4xMDU1IDE2LjIzMTJaIiBmaWxsPSIjMkEyOTQxIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTguMjM5MSAyMi4wMzMyTDE0Ljg1MjIgMjcuMzM1MkwxNi42ODM3IDMxLjg2MTlMMjIuNTI5MiAzMi41MTIyTDI2LjMxNzUgMjguMTg1NUwyNC40MzU5IDIzLjMwODdMMTguMjM5MSAyMi4wMzMyWiIgZmlsbD0iIzJBMjk0MSIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTM3LjYzMjMgMTMuMzMwMUwxOS42OTQzIDIwLjg4M0wyOC4xNDkgNDEuMjQwN0w0Ni4wMTE4IDMzLjkzNzlMMzcuNjMyMyAxMy4zMzAxWiIgZmlsbD0iI0ZFQzM0RSIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQ3LjE2NTggMzQuMzg4TDM4LjMwOTcgMTIuNTU0N0wxOS4xNjc0IDIwLjYwNzdMMjguMDk4OCA0Mi4xNjU5TDQ3LjE2NTggMzQuMzg4Wk0zNy41ODIyIDE0LjI1NTNMNDUuNDg0OSAzMy42NjI3TDI4LjgyNjQgNDAuNTE1M0wyMC44NDgzIDIxLjMwOEwzNy41ODIyIDE0LjI1NTNaIiBmaWxsPSIjMkEyOTQxIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNDEuOTk3NyAyNi4yNkwyOS4xNTI1IDMxLjY2MjFMMzEuOTg3NSAzOC45Mzk4TDQ0Ljk4MzIgMzMuNjg3OEw0MS45OTc3IDI2LjI2WiIgZmlsbD0iIzMyRURCQiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQ2LjQ4ODUgMzQuMDg3OEw0Mi45MDA5IDI1LjIwOTVMMjguNjI1NyAzMS4yMTE4TDMyLjAzNzcgMzkuOTE1MUw0Ni40ODg1IDM0LjA4NzhaTTQyLjQ3NDQgMjYuMjA5OUwyOS42MjkyIDMxLjYxMTlMMzIuNDY0MiAzOC44ODk3TDQ1LjQ1OTkgMzMuNjM3N0w0Mi40NzQ0IDI2LjIwOTlaIiBmaWxsPSIjMkEyOTQxIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMzIuMTYzMSAzMC41NjE0TDM2LjA3NjggMjguOTM1OEwzNC42MjE3IDI1LjE1OTRMMzUuNzc1OCAyNC42NTkyTDM4LjIzNDQgMzAuNDg2NEw0MC41NDI1IDI2LjU1OTlMMzguMTA5IDIwLjM1NzZDMzYuMjAyMyAxNi4zNTYgMjguMDk4OCAxOS45NTc0IDI5LjMwMyAyMy42MDg4TDMyLjE2MzEgMzAuNTYxNFoiIGZpbGw9IiNBNjk0RkUiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0zMi4xNjMxIDMwLjU2MTRMMzYuMDc2OCAyOC45MzU4TDM0LjYyMTcgMjUuMTU5NEwzNS43NzU4IDI0LjY1OTJMMzguMjM0NCAzMC40ODY0TDQwLjU0MjUgMjYuNTU5OUwzOC4xMDkgMjAuMzU3NkMzNi4yMDIzIDE2LjM1NiAyOC4wOTg4IDE5Ljk1NzQgMjkuMzAzIDIzLjYwODhMMzIuMTYzMSAzMC41NjE0Wk0zMi41ODk2IDI5LjU2MTFMMzAuMDMwNiAyMy4zMzM3QzI5LjgyOTkgMjIuNjgzNCAzMC4wNTU3IDIyLjAzMzIgMzAuNTA3MiAyMS40NThDMzEuMDU5MiAyMC43NTc3IDMxLjg4NzEgMjAuMTgyNSAzMi44NDA0IDE5LjgwNzRDMzQuNTQ2NCAxOS4xMDcxIDM2LjYyODggMTkuMDMyMSAzNy40MDY1IDIwLjYzMjdMMzkuNjg5NSAyNi40ODQ5TDM4LjM1OTggMjguNzYwOEwzNi4yMDIzIDIzLjYzMzhMMzMuNjE4MiAyNC43NTkyTDM1LjA3MzMgMjguNTEwN0wzMi41ODk2IDI5LjU2MTFaIiBmaWxsPSIjMkEyOTQxIi8+CjxwYXRoIGQ9Ik0zNC42NzE5IDIxLjQzMzFMMzEuMjg1IDIyLjgzMzZMMzIuOTkxIDI2Ljk2MDJMMzYuMzc3OSAyNS41NTk3TDM0LjY3MTkgMjEuNDMzMVoiIGZpbGw9IiNGNUY1RjUiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0zNS45NTE0IDI2Ljg2MDFMMzQuMzcwOSAyNy41MTA0TDM1LjA5ODQgMjkuMjM2TDMzLjExNjUgMzAuMDg2M0MzMy41NjggMzEuMjYxOCAzNC4zNDU4IDMxLjU4NjkgMzUuOTUxNCAzMC45ODY3TDM3LjQzMTYgMzAuMzM2NEwzNS45NTE0IDI2Ljg2MDFaIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMzcuMzU2NCAyNi4xMzQ5TDM1LjA0ODMgMjAuNTgyOEwzMC4yMzEzIDIyLjU1ODVMMzIuNTM5NCAyOC4xMTA2TDM3LjM1NjQgMjYuMTM0OVpNMzQuNjIxOCAyMS41ODMxTDMxLjIzNDkgMjIuOTgzN0wzMi45NDA4IDI3LjExMDJMMzYuMzI3OCAyNS43MDk3TDM0LjYyMTggMjEuNTgzMVoiIGZpbGw9IiMyQTI5NDEiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0zOC45MTE4IDMwLjYxMTVMMzYuODU0NiAyNS43MzQ2TDMzLjg0NCAyNi45ODUxTDM0LjU3MTYgMjguNzEwOEwzMi41ODk2IDI5LjU2MTFMMzIuODQwNSAzMC4yNjEzQzMzLjE2NjYgMzEuMTExNyAzMy42NDMzIDMxLjYxMTkgMzQuMjk1NiAzMS44MzY5QzM0Ljg3MjYgMzIuMDM3IDM1LjY1MDQgMzEuOTg3IDM2LjY3OSAzMS41ODY4SDM2LjcwNDFDMzYuNzI5MiAzMS41ODY4IDM4LjkxMTggMzAuNjExNSAzOC45MTE4IDMwLjYxMTVaTTM2LjQyODEgMjYuNzZMMzQuODQ3NSAyNy40MTAzTDM1LjU3NTEgMjkuMTM1OUwzMy41OTMxIDI5Ljk4NjJDMzQuMDQ0NyAzMS4xNjE3IDM0LjgyMjUgMzEuNDg2OCAzNi40MjgxIDMwLjg4NjZMMzcuOTA4MyAzMC4yMzYzTDM2LjQyODEgMjYuNzZaIiBmaWxsPSIjMkEyOTQxIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTkuMzE3OSAxOS4xMzIxTDE1LjkwNTkgMjQuNDM0MUwxNy43Mzc0IDI4Ljk2MDhMMjMuNTgyOSAyOS42MTExTDI3LjM3MTMgMjUuMjg0NEwyNS40ODk2IDIwLjQwNzZMMTkuMzE3OSAxOS4xMzIxWiIgZmlsbD0iI0Y1RjVGNSIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTI1Ljg5MSAxOS44MDczTDE4Ljc0MDkgMTguMzMxOEwxNC44NTIyIDI0LjQzNDFMMTcuMDA5OCAyOS43NjExTDIzLjcwODQgMzAuNTExNEwyOC4wNzM3IDI1LjUwOTVMMjUuODkxIDE5LjgwNzNaTTE5LjExNzIgMTkuMjA3MUwxNS43MzAzIDI0LjUwOTFMMTcuNTYxOCAyOS4wMzU5TDIzLjQwNzMgMjkuNjg2MUwyNy4xOTU2IDI1LjM1OTVMMjUuMzM5MSAyMC40ODI2TDE5LjExNzIgMTkuMjA3MVoiIGZpbGw9IiMyQTI5NDEiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yNS4xMTMzIDIxLjAwOEwyMi4zMjg1IDIwLjczMjlMMjIuMjUzMiAyMS41ODMyTDI1LjAzOCAyMS44NTgzTDI1LjExMzMgMjEuMDA4WiIgZmlsbD0iIzJBMjk0MSIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTI1LjQxNDQgMjUuNzM0NkwyMy41ODI5IDIxLjAwNzhMMjIuNzgwMSAyMS4zMDc5TDI0LjYxMTUgMjYuMDM0N0wyNS40MTQ0IDI1LjczNDZaIiBmaWxsPSIjMkEyOTQxIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjIuODMwMyAyMy43MDlMMjAuNjcyNyAyNC41MzQzTDIwLjk3MzcgMjUuMzM0NkwyMy4xMzEzIDI0LjUwOTNMMjIuODMwMyAyMy43MDlaIiBmaWxsPSIjMkEyOTQxIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjIuNjI5NiAyNy44ODU1TDIwLjE0NTkgMjEuMzgzTDIxLjgyNjggMjEuNTMzMUwyMS45MDIgMjAuNjgyOEwxOS41NDM3IDIwLjQ1NzdDMTkuMzkzMiAyMC40MzI3IDE5LjI2NzggMjAuNTA3NyAxOS4xNjc0IDIwLjYzMjdDMTkuMDY3MSAyMC43NTc4IDE5LjA2NzEgMjAuOTA3OCAxOS4xMTcyIDIxLjAzMjlMMjEuODI2OCAyOC4xODU2TDIyLjYyOTYgMjcuODg1NVoiIGZpbGw9IiMyQTI5NDEiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xOS4xOTI1IDI3LjkzNTVMMTguNDE0OCAyNS44ODQ3TDIwLjQ0NjkgMjcuODg1NUMyMC41OTc1IDI4LjAzNTUgMjAuNzk4MiAyOC4wMzU1IDIwLjk3MzggMjcuOTM1NUMyMS4xNDk0IDI3LjgzNTUgMjEuMTk5NiAyNy42MTA0IDIxLjE0OTQgMjcuNDM1M0wxOS4xNDIzIDIyLjEzMzNMMTguMzM5NSAyMi40MzM0TDE5LjY2OTIgMjUuOTA5N0wxNy42MzcgMjMuOTA5QzE3LjQ4NjUgMjMuNzU4OSAxNy4yODU4IDIzLjczMzkgMTcuMTEwMiAyMy44NTlDMTYuOTM0NiAyMy45NTkgMTYuODg0NCAyNC4xODQxIDE2LjkzNDYgMjQuMzU5MUwxOC40MTQ4IDI4LjIzNTZMMTkuMTkyNSAyNy45MzU1WiIgZmlsbD0iIzJBMjk0MSIvPgo8L3N2Zz4=`;

  // Call the mint function from our contract
  const txn = await onChainNFT.mint(base64EncodeOfTheSVG);
  const txnReceipt = await txn.wait();

  // Get the token id of the minted NFT (using our event)
  const event = txnReceipt.events?.find((event: { event: string; }) => event.event === 'Minted');
  const tokenId = event?.args['tokenId'];

  console.log(
    'ðŸŽ¨ Your minted NFT:',
    `https://testnets.opensea.io/assets/${onChainNFT.target}/${tokenId}`
  );
};

const runMain = async () => {
  try {
    await main();
    process.exit(0);
  } catch (error) {
    console.log(error);
    process.exit(1);
  }
};

runMain();